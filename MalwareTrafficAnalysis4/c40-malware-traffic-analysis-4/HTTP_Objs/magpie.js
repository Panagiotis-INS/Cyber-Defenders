/**
 * Magpie 2.6.5
 * Bazaarvoice Analytics Client
 *
 * Acknowledgements:
 *
 * ///////////////////////////////////////////////////////////////////////////////////////////////
 *
 * lib/rison:
 *
 * Rison
 * the stringifier is based on http://json.org/json.js as of 2006-04-28 from json.org
 * the parser is based on http://osteele.com/sources/openlaszlo/json
 *
 * ///////////////////////////////////////////////////////////////////////////////////////////////
 *
 * requirejs, require, define
 *
 * almond 0.0.3 Copyright (c) 2011, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 *
 * ///////////////////////////////////////////////////////////////////////////////////////////////
 *
 * lib/has:
 *
 * Tentatively, has.js is available under the Academic Free License, New BSD License, and the MIT License.
 *
 * ///////////////////////////////////////////////////////////////////////////////////////////////
 *
 * lib/cookie:
 *
 * Copyright (c) 2005-2011, The Dojo Foundation
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 *   * Redistributions of source code must retain the above copyright notice, this
 *     list of conditions and the following disclaimer.
 *   * Redistributions in binary form must reproduce the above copyright notice,
 *     this list of conditions and the following disclaimer in the documentation
 *     and/or other materials provided with the distribution.
 *   * Neither the name of the Dojo Foundation nor the names of its contributors
 *     may be used to endorse or promote products derived from this software
 *     without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
 * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
 * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
 * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * ///////////////////////////////////////////////////////////////////////////////////////////////
 *
 * lib/random
 *
 * Copyright (C) 2010 by Johannes Baag√∏e <baagoe@baagoe.org>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */

;(function() {
var requirejs,require,define;(function(a){function g(a,b){if(a&&a.charAt(0)==="."&&b){b=b.split("/"),b=b.slice(0,b.length-1),a=b.concat(a.split("/"));var c,d;for(c=0;d=a[c];c++)if(d===".")a.splice(c,1),c-=1;else if(d==="..")if(c!==1||a[2]!==".."&&a[0]!=="..")c>0&&(a.splice(c-1,2),c-=2);else break;a=a.join("/")}return a}function h(b,c){return function(){return f.apply(a,d.call(arguments,0).concat([b,c]))}}function i(a){return function(b){return g(b,a)}}function j(a){return function(c){b[a]=c}}function k(d){if(c.hasOwnProperty(d)){var f=c[d];delete c[d],e.apply(a,f)}return b[d]}function l(a,b){var c,d,e=a.indexOf("!");return e!==-1?(c=g(a.slice(0,e),b),a=a.slice(e+1),d=k(c),d&&d.normalize?a=d.normalize(a,i(b)):a=g(a,b)):a=g(a,b),{f:c?c+"!"+a:a,n:a,p:d}}var b={},c={},d=[].slice,e,f;if(typeof define=="function")return;e=function(d,e,f,g){var i=[],m,n,o,p,q,r;g||(g=d);if(typeof f=="function"){!e.length&&f.length&&(e=["require","exports","module"]);for(p=0;p<e.length;p++){r=l(e[p],g),o=r.f;if(o==="require")i[p]=h(d);else if(o==="exports")i[p]=b[d]={},m=!0;else if(o==="module")n=i[p]={id:d,uri:"",exports:b[d]};else if(b.hasOwnProperty(o)||c.hasOwnProperty(o))i[p]=k(o);else if(r.p)r.p.load(r.n,h(g,!0),j(o),{}),i[p]=b[o];else throw d+" missing "+o}q=f.apply(b[d],i),d&&(n&&n.exports!==a?b[d]=n.exports:m||(b[d]=q))}else d&&(b[d]=f)},requirejs=f=function(b,c,d,g){return typeof b=="string"?k(l(b,c).f):(b.splice||(c.splice?(b=c,c=arguments[2]):b=[]),g?e(a,b,c,d):setTimeout(function(){e(a,b,c,d)},15),f)},f.config=function(){return f},require||(require=f),define=function(a,b,d){b.splice||(d=b,b=[]),define.unordered?c[a]=[a,b,d]:e(a,b,d)},define.amd={jQuery:!0}})()
define("lib/rison",[],function(){"a".replace(/a/,function(){return"b"})!=="b"&&function(e){String.prototype.replace=function(t,n){if(typeof n!="function")return e.apply(this,arguments);var r=""+this;if(t instanceof RegExp){var s=t,o=[],u=s.lastIndex,a;while((a=s.exec(r))!==null){i=a.index;var f=a.concat(i,r);o.push(r.slice(u,i),n.apply(null,f).toString());if(!s.global){u+=RegExp.lastMatch.length;break}u=s.lastIndex}return o.push(r.slice(u)),o.join("")}var i=r.indexOf(t);return i===-1?r:e.apply(r,[t,n(t,i,r)])}}(String.prototype.replace);var e={};return e.uri_ok={"~":!0,"!":!0,"*":!0,"(":!0,")":!0,"-":!0,_:!0,".":!0,",":!0,":":!0,"@":!0,$:!0,"'":!0,"/":!0},function(){var t=[];for(var n=0;n<16;n++)for(var r=0;r<16;r++){if(n+r===0)continue;var i=String.fromCharCode(n*16+r);/\w|[\-_.\/~]/.test(i)||t.push("\\u00"+n.toString(16)+r.toString(16))}e.not_idchar=t.join("")}(),e.not_idchar=" 	\r\n\"<>\\[\\]{}'!=:(),*@$;&",e.not_idstart="-0123456789",function(){var t="[^"+e.not_idstart+e.not_idchar+"][^"+e.not_idchar+"]*";e.id_ok=new RegExp("^"+t+"$"),e.next_id=new RegExp(t,"g")}(),e.quote=function(t){var n=e.uri_ok;return/^[A-Za-z0-9_\-]*$/.test(t)?t:(t=t.replace(/([^A-Za-z0-9_\-])/g,function(e,t){var r=n[t];return r?t:encodeURIComponent(t)}),t.replace(/%20/g,"+"))},function(){var t={"'":!0,"!":!0},n={array:function(e){var t=["!("],r,i,o,u=e.length,a;for(o=0;o<u;o+=1)a=e[o],i=n[typeof a],i&&(a=i(a),typeof a=="string"&&(r&&(t[t.length]=","),t[t.length]=a,r=!0));return t[t.length]=")",t.join("")},"boolean":function(e){return e?"!t":"!f"},"null":function(){return"!n"},number:function(e){return isFinite(e)?String(e).replace(/\+/,""):"!n"},object:function(e){if(e){if(e instanceof Array)return n.array(e);if(typeof e.__prototype__=="object"&&typeof e.__prototype__.encode_rison!="undefined")return e.encode_rison();var t=["("],r,i,o,u,a,f=[];for(o in e)f[f.length]=o;f.sort();for(a=0;a<f.length;a++)o=f[a],u=e[o],i=n[typeof u],i&&(u=i(u),typeof u=="string"&&(r&&(t[t.length]=","),t.push(n.string(o),":",u),r=!0));return t[t.length]=")",t.join("")}return"!n"},string:function(n){return n===""?"''":e.id_ok.test(n)?n:(n=n.replace(/(['!])/g,function(e,n){return t[n]?"!"+n:n}),"'"+n+"'")},"undefined":function(){return"!n"}};e.encode=function(e){return n[typeof e](e)}}(),e}),define("lib/random",[],function(){function s(){return function(e){var t=0,n=0,r=0,u=1;e.length===0&&(e=i);var a=o();t=a(" "),n=a(" "),r=a(" ");for(var f=0;f<e.length;f++)t-=a(e[f]),t<0&&(t+=1),n-=a(e[f]),n<0&&(n+=1),r-=a(e[f]),r<0&&(r+=1);a=null;var l=function(){var e=2091639*t+u*2.3283064365386963e-10;return t=n,n=r,r=e-(u=e|0),r};return l.uint32=function(){return l()*4294967296},l.fract53=function(){return l()+(l()*2097152|0)*1.1102230246251565e-16},l.version="Alea 0.9",l.args=e,l.Alea=s,l}(Array.prototype.slice.call(arguments))}function o(){var e=4022871197,t=function(t){t=""+t;for(var n=0;n<t.length;n++){e+=t.charCodeAt(n);var r=.02519603282416938*e;e=r>>>0,r-=e,r*=e,e=r>>>0,r-=e,e+=r*4294967296}return(e>>>0)*2.3283064365386963e-10};return t.version="Mash 0.9",t}var e=window,t=e.navigator,n=document,r=window.location,i=[t&&t.userAgent,r&&r.href,n.referrer,(new Date).getTime(),Math.random()];return s()}),define("lib/util",["./rison","./random"],function(e,t){var n=Object.prototype.toString,r={log:function(){window.Debug&&window.Debug.writeln?Debug.writeln([].join.call(arguments,", ")):window.console&&window.console.log?window.console.log.apply(window.console,arguments):window.opera&&window.opera.postError&&window.opera.postError([].join.call(arguments,", "))},extend:function(e){var t=[].slice.call(arguments,1),n,r;for(var i in t)if(t.hasOwnProperty(i)){n=t[i];for(r in n)n.hasOwnProperty(r)&&(e[r]=n[r])}return e},buster:function(){return Math.round(Math.random()*2147483647)},isArray:Array.isArray||function(e){return n.call(e)==="[object Array]"},isFunction:function(e){return n.call(e)==="[object Function]"},isString:function(e){return n.call(e)==="[object String]"},isObject:function(e){return e===Object(e)},isNumber:function(e){return n.call(e)==="[object Number]"},isIE:function(){var e=3,t=document.createElement("div"),n=t.getElementsByTagName("i");do t.innerHTML="<!--[if gt IE "+ ++e+"]><i></i><![endif]-->";while(n[0]);return e>4?!0:!1}(),loadId:function(){var e=16,n=20,r=Math.floor(Math.random()*(n-e+1)+e),i="",s=0;while(s++<r)i+=(t()*16|0).toString(16);return i},uuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var n=t()*16|0,r=e==="x"?n:n&3|8;return r.toString(16)})}};return r}),define("lib/jsonp",["./util"],function(e){function s(e){var t=i.createElement("script"),r=!1;t.src=e,t.async=!0,t.onload=t.onreadystatechange=function(){!r&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")&&(r=!0,t.onload=t.onreadystatechange=null,t&&t.parentNode&&t.parentNode.removeChild(t))},n||(n=i.getElementsByTagName("head")[0]),n.appendChild(t)}function o(n,i,o){var u=(n||"").indexOf("?")===-1?"?":"&",a;return e.isFunction(i)&&(a="_bvajsonp"+ ++t,r[a]=function(e){try{delete r[a]}catch(t){r[a]=null}i(e)},s(n+u+(o||"callback")+"="+a)),a}var t=0,n,r=window,i=document;return{get:o}}),function(e){function a(t){return typeof u[t]=="function"&&(u[t]=u[t](e,r,i)),u[t]}function f(t,n,s){u[t]=s?n(e,r,i):n}function l(e,t){var r=!1,i=e.charAt(0).toUpperCase()+e.slice(1),s=n.length,o=t.style;if(typeof o[e]=="string")r=!0;else while(s--)if(typeof o[n[s]+i]=="string"){r=!0;break}return r}function c(e){if(e)while(e.lastChild)e.removeChild(e.lastChild);return e}function h(e,n){var r=typeof e[n];return r==="object"?!!e[n]:!t[r]}var t={"boolean":1,number:1,string:1,"undefined":1},n=["Webkit","Moz","O","ms","Khtml"],r=h(e,"document")&&e.document,i=r&&h(r,"createElement")&&r.createElement("DiV"),s=!1,o=typeof window.module=="object"&&window.module,u={};a.add=f,a.clearElement=c,a.cssprop=l,a.isHostType=h,a._tests=u,a.add("dom",function(e,t,n){return t&&n&&h(e,"location")&&h(t,"documentElement")&&h(t,"getElementById")&&h(t,"getElementsByName")&&h(t,"getElementsByTagName")&&h(t,"createComment")&&h(t,"createElement")&&h(t,"createTextNode")&&h(n,"appendChild")&&h(n,"insertBefore")&&h(n,"removeChild")&&h(n,"getAttribute")&&h(n,"setAttribute")&&h(n,"removeAttribute")&&h(n,"style")&&typeof n.style.cssText=="string"}),s?o&&o.exports===s?(o.exports=a).has=a:s.has=a:typeof define=="function"&&typeof define.amd=="object"&&define.amd?define("lib/has",[],function(){return a}):e.has=a}(this),define("lib/event",[],function(){return{add:function(e,t,n,r){e.addEventListener?e.addEventListener(t,n,!!r):e.attachEvent&&e.attachEvent("on"+t,n)},remove:function(e,t,n,r){e.removeEventListener?e.removeEventListener(t,n,!!r):e.detachEvent&&e.detachEvent("on"+t,n)}}}),define("lib/cookie",[],function(){var e=function(e,t){return e.replace(/([\.$?*|{}\(\)\[\]\\\/\+\^])/g,function(e){return t&&t.indexOf(e)!==-1?e:"\\"+e})},t=function(t,n,r){var i=document.cookie,s;if(arguments.length===1){var o=i.match(new RegExp("(?:^|; )"+e(t)+"=([^;]*)"));s=o?decodeURIComponent(o[1]):undefined}else{r=r||{};var u=r.expires;if(typeof u=="number"){var a=new Date;a.setTime(a.getTime()+u*24*60*60*1e3),u=r.expires=a}if(u&&u.toUTCString){var f=Number(new Date)+31536e6;u.setTime(Math.min(f,u.getTime())),r.expires=u.toUTCString()}n=encodeURIComponent(n);var l=t+"="+n,c;for(c in r){l+="; "+c;var h=r[c];h!==!0&&(l+="="+h)}document.cookie=l}return s};return t.isSupported=function(){if(navigator.cookieEnabled)return!0;document.cookie="bvcookietest=1";var e=document.cookie.indexOf("bvcookietest=")!==-1;return document.cookie="bvcookietest=1; expires=Thu, 01-Jan-1970 00:00:01 GMT",e},t}),define("lib/browser",["./cookie"],function(e){var t=window.navigator,n=window.screen,r=document,i=r.getElementsByTagName("link"),s=i.length,o,u;for(u=0;u<s;u++)i[u].getAttribute("rel")==="canonical"&&(o=i[u].href);return{host:window.location.host,ref:r.referrer,canurl:o,res:n?n.width+"x"+n.height:"-",lang:(t&&(t.language||t.browserLanguage)||"-").toLowerCase(),charset:r.characterSet||r.charset||"-",geo:navigator.geolocation?1:0,cookies:e.isSupported()?1:0}}),define("lib/pixel",["./util","./rison","./has"],function(e,t,n){function f(e,t){var n,r,i,s,o="";e=e||[],s=e.length;for(n=0;t>0&&n<s;n++){r=e[n]||"";if(r.length+1>t){r=r.substr(0,t-1);if(r.indexOf("=")===-1)continue}i="&"+r,o+=i,t-=i.length}return o}function l(n,i){var s=null;if(n!==undefined&&i!==undefined)try{if(e.isArray(i)||e.isObject(i))n=r+n,i=t.encode(i);s=t.quote(n)+"="+t.quote(""+i)}catch(o){}return s}function c(t){var n,r,i=o[t.cl]||{},s=0,a=[],f=[],c={optional:[],longestField:null};if(!e.isObject(t))return null;for(n in t){if(!t.hasOwnProperty(n))continue;r=l(n,t[n]);if(r===null)continue;if(i&&n in i)c.optional.push(r);else{if(n in u){var h=u[n];a.length>h?a.splice(h,0,r):a.push(r)}else f.push(r);r.length>s&&(c.longestField=n,s=r.length)}}return c.required=a.concat(f).join("&"),c}var r="r_",i=2036,s=e.isIE?i:8192,o={PageView:{ref:1}},u={cl:0,loadId:1,type:2},a=function(t,n,r,i,s,o,u){var a=(n?"a":"st")+(t?".json":".gif");this.anonymous=n,this.secure=r,this.hostname=i,this.protocol=r||document.location.protocol==="https:"?"https:":"http:",this._baseUrl=this.protocol+"//"+this.hostname+"/"+a,this._sharedData=s,this._brandCookies=o,this.data=u,this.tooLong=!1,this.validating=t,e.isObject(this.data)?(this.data.cl=this.data.cl||null,this.ev=this._buildEvent(this.data),this.url=this._buildUrl({ev:this.ev,ignoreTooLong:!1})):this.url=""};return a.MAX_URL_LENGTH=s,a.prototype._buildEvent=function(t){var n=e.extend({},this._sharedData,this._brandCookies,t);return n._=e.buster(),n},a.prototype._buildUrl=function(e){var t=e||{},n,r,i;return n=c(e.ev),n?(r=this._baseUrl+"?"+n.required,i=s-r.length,i<0?(r=t.ignoreTooLong?"":this._urlTooLong(r,n),this.tooLong=!0):n.optional.length>0&&(r+=f(n.optional,i)),r):""},a.prototype._urlTooLong=function(e,t){var n={cl:"Magpie",type:"LongUrl",length:(e||"").length,maxLength:s,targetCl:this.data.cl?this.data.cl.substr(0,200):null,longestField:t.longestField.substr(0,200)};return this._buildUrl({ev:this._buildEvent(n),ignoreTooLong:!0})},a}),define("lib/conversion",["./util"],function(e){function a(e,t){var n=e&&e[t];return n!==null&&n!==undefined}function f(t,n){var r=n.length;if(!e.isObject(t)&&r<0)return!1;while(r--)if(!a(t,n[r]))return!1;return!0}function l(e){return f(e,i)}var t="Conversion",n="PII"+t,r={orderId:1,affiliation:1,total:1,tax:1,shipping:1,city:1,state:1,country:1,currency:1,items:1,locale:1,type:1,label:1,value:1,proxy:1,partnerSource:1,TestCase:1,TestSession:1},i=["type"],s="public_",o=function(e){var t;this._data=e,this._anonymized={},this._hasPII=!1;for(t in e)e.hasOwnProperty(t)&&(r[t]||t.indexOf(s)===0?this._anonymized[t]=e[t]:this._hasPII=!0);this._hasPII===!0&&(this._anonymized.hadPII=!0)},u=o.prototype;return u.containsPII=function(){return this._hasPII},u.getAnonymizedData=function(){return this._anonymized},u.getPIIData=function(){return this._data},{EVENT_CLASS:t,PII_EVENT_CLASS:n,create:function(e){return l(e)?new o(e):null}}}),define("lib/sci",["./has","./util"],function(has,util){var vendorMap={ADOBE:"AdobeSiteCatalyst",IBM:"IBMDigitalAnalytics",GOOGLE:"GoogleAnalytics"},eventGroup="Bazaarvoice",delimiter=" : ",trackingMap={Ask:{label:["Button"]},Click:{label:["SecondaryContentLink","ViewProfileButton","Stars","ReadReviewButton","SummaryStars","WriteReviewLabel","ReviewCount","SummaryQuestionStats","YesHelpfulVote","NoHelpfulVote","ReportLink","UserSubmittedMedia","YesVote","NoVote","Report","UserSubmittedPhoto"]},Close:{label:["Submission","SecondaryContent","UserSubmittedMedia","Search","UserSubmittedPhoto"]},Filter:{label:["1Star","2Stars","3Stars","4Stars","5Stars","Clear1Star","Clear2Stars","Clear3Stars","Clear4Stars","Clear5Stars","ClearAll"]},Hover:{label:["Histogram","Profile"]},Paginate:{label:["First","Last","Next","Prev"]},Search:{label:["UserGeneratedContent","SearchBarRatingSummary","TopicsAndReviews"]},Share:{label:["Button"]},Sort:{label:["featured","mostRecent","oldest","positive","negative","mostHelpful","mostUnhelpful","relevancy","recentQuestionsFirst","recentQuestionsLast","recentAnswersFirst","recentAnswersLast","mostAnsweredQuestionsFirst","mostAnsweredQuestionsLast","featuredQuestionsFirst","helpfulnessAnswersFirst","helpfulnessAnswersLast"]},Write:{label:["Button"]}},getSiteCatalystTracker=function(e){var t=e||"s",n=window[t];if(!n||typeof n!="object"){util.log(t+" bad trackerRef");return}return n},getGoogleAnalyticsTracker=function(vendorTracker,method){var trackerRef=vendorTracker,trackerMethod=method,tracker,trackerType="object";if(!trackerRef)if(!!trackerMethod&&trackerMethod!=="SYNCHRONOUS"||typeof pageTracker!="object")if(!!trackerMethod&&trackerMethod!=="ASYNCHRONOUS"||typeof _gaq!="object"){if(!!trackerMethod&&trackerMethod!=="UNIVERSAL"||typeof ga!="function"){util.log("getGoogleAnalyticsTracker: could not determine trackerRef");return}trackerRef="ga",trackerMethod="UNIVERSAL"}else trackerRef="_gaq",trackerMethod="ASYNCHRONOUS";else trackerRef="pageTracker",trackerMethod="SYNCHRONOUS";else if(!method)if(trackerRef==="pageTracker")trackerMethod="SYNCHRONOUS";else if(trackerRef==="_gaq")trackerMethod="ASYNCHRONOUS";else{if(trackerRef!=="ga"){util.log("getGoogleAnalyticsTracker: could not determine trackerMethod");return}trackerMethod="UNIVERSAL"}if(trackerRef==="ga"||trackerMethod==="UNIVERSAL")trackerType="function";tracker=window[trackerRef];if(!tracker||typeof tracker!==trackerType){try{tracker=eval(trackerRef)}catch(e){return}if(!tracker||typeof tracker!==trackerType){util.log(trackerRef+" bad trackerRef");return}}if(trackerMethod==="SYNCHRONOUS")return{trackEvent:function(e,t,n,r,i){tracker._trackEvent(e,t,n,r,i)}};if(trackerMethod==="ASYNCHRONOUS")return{trackEvent:function(e,t,n,r,i){tracker.push(["_trackEvent",e,t,n,r,i])}};if(trackerMethod==="UNIVERSAL")return{trackEvent:function(e,t,n,r,i){tracker("send","event",e,t,n,r,{nonInteraction:i})}};util.log("getGoogleAnalyticsTracker: trackEvent could not be defined")},callWap=function(e,t){var n={},r=[];for(var i=2;i<arguments.length;i++)r.push((arguments[i]||"").toString());var s=r.join("~#~");if(!n[s]){n[s]=!0;try{t.apply(e,[].slice.call(arguments,2))}catch(o){util.log("Error calling WAP "+o.description,o)}}},isEventTracked=function(e,t,n){if(e==="Feature"&&t in trackingMap)for(var r=0;r<trackingMap[t].label.length;r++)if(trackingMap[t].label[r]===n||trackingMap[t].label[r]==="ANY")return!0;return!1},adobeSiteCatalystCallback=function(e){var t=e||{},n=getSiteCatalystTracker(t.tracker||null);return n?function(e){if(isEventTracked(e.cl,e.name,e.detail1)){var r=window.event||window,i=t.event,s=t.evar,o=e.detail1.charAt(0).toUpperCase()+e.detail1.slice(1),u=eventGroup+delimiter+e.bvProduct+delimiter+e.name+o;n.linkTrackEvents="event"+i,n.events="event"+i,n["eVar"+s]=u,n.linkTrackVars="events,evar"+s,n.products&&(n.linkTrackVars+=",products",n.products=n.products.replace(/([^,;]*;[^,;]*);[^,]*/g,"$1")),n.linkTrackVars+=",eVar"+s,callWap(n,n.tl,r,"o",u+delimiter+e.productId)}}:function(){}},ibmDigitalAnalyticsCallback=function(e){if(typeof window.cG7=="object"&&isEventTracked(e.cl,e.name,e.detail1)){var t=window.cG7.cM0[window.cm_ClientID],n=eventGroup+delimiter+e.bvProduct,r=e.detail1.charAt(0).toUpperCase()+e.detail1.slice(1);callWap(window,window.cmCreateElementTag,e.name+r,n),window.cG7.cM0[window.cm_ClientID]=t}},googleAnalyticsCallback=function(e){var t=e||{},n=getGoogleAnalyticsTracker(t.tracker||null,t.method);return n?function(e){var t=eventGroup+delimiter+e.bvProduct+delimiter,r=window.location.pathname;if(e.cl==="PageView"&&e.bvProduct)callWap(n,n.trackEvent,"Bazaarvoice Content Loaded",t+"Product"+e.cl,r,undefined,!0);else if(isEventTracked(e.cl,e.name,e.detail1)){var i=e.detail1.charAt(0).toUpperCase()+e.detail1.slice(1);callWap(n,n.trackEvent,eventGroup+" "+e.bvProduct,t+e.name+i,r,undefined,!1)}}:function(){}},_sci={create:function(e,t){throw new Error("SCI web analytics provider support is not included in this build of magpie.js")}};return _sci.getSiteCatalystTracker=getSiteCatalystTracker,_sci.getGoogleAnalyticsTracker=getGoogleAnalyticsTracker,_sci.isEventTracked=isEventTracked,_sci.callWap=callWap,_sci}),define("lib/transformData",[],function(){function e(e,t,n){if(typeof e=="undefined"||e===null)return;if(t===n)return;e.hasOwnProperty(t)&&(e[n]=e[t],delete e[t])}return e}),define("lib/tracker",["./util","./jsonp","./has","./event","./browser","./cookie","./pixel","./conversion","./sci","./transformData"],function(e,t,n,r,i,s,o,u,a,f){function v(t,n){this._settings=e.extend({},this._defaults),this.version="2.6.5",this._shared={},this._shared.loadId=c,this._shared.tz=(new Date).getTimezoneOffset(),this._shared.magpieJsVersion=this.version,this._shared.source=null,this._shared.environment=null,this._sciCallbacks=[],t&&this.setClient(t),n&&this.setDisplay(n),this._batch=null,this._unloaded=!1;var i=this;r.add(window,"unload",function(){i._unload()}),r.add(window,"beforeunload",function(){i._unload()}),this._bvCookiesRequest=h,this._requestQueue=[],this._id=null,this._idQueue=[]}var l={"public":1,"private":1,internal:1},c=e.loadId(),h=0,p=1,d=2,m=v.prototype;return m._defaults={trackerHostname:"network.bazaarvoice.com",anonTrackerHostname:"network-a.bazaarvoice.com",anonymous:!0,brandDomain:null,timing:!0,staging:!1,secure:!1,eventFilter:null},m._set=function(e,t){this._settings[e]=t},m._get=function(e){return this._settings[e]},m._filterClass=function(e){var t=this.getEventClassFilter();return t&&!t.exec(e)},m._getProtocol=function(){return this.getSecure()||document.location.protocol==="https:"?"https:":"http:"},m._trackerUrl=function(t,n){var r=this._getProtocol()+"//"+this.getTrackerHostname()+"/"+t;return n&&(r+="?_="+e.buster()),r},m._getPixel=function(e){var t=this.getAnonymous(),n=this.getSecure(),r=t?this.getAnonTrackerHostname():this.getTrackerHostname(),i=this._getBrandCookies();return new o(this.isValidating(),t,n,r,this._shared,i,e)},m._send=function(e){e.validating?(this._sendValidatingRequest(e),this._fireSCICallbacks(e.ev)):e.anonymous?(this._sendRequest(e.url),this._fireSCICallbacks(e.ev)):this._sendTrackedRequest(e)},m._fireSCICallbacks=function(t){if(this._sciCallbacks&&this._sciCallbacks.length>0){if(t.batch){var n=e.extend({},t),r=n.batch;delete n.batch;for(var i=0;i<r.length;i++)t=e.extend({},n,r[i]),this._fireSCICallbacks(t);return}for(var s=0;s<this._sciCallbacks.length;s++)try{this._sciCallbacks[s](t)}catch(o){}}},m._sendTrackedRequest=function(e){var t=this;t._bvCookiesRequest===h&&t._setBVCookies(),t._bvCookiesRequest===d?(t._sendRequest(e.url),this._fireSCICallbacks(e.ev)):t._requestQueue.push(e)},m._setBVCookies=function(){var e=this,t=e._trackerUrl("sid.gif",!0);e._sendRequest(t,function(){e._bvCookiesRequest=d,e._flushRequestQueue(),e._loadBVID()}),e._bvCookiesRequest=p},m._flushRequestQueue=function(){while(this._requestQueue.length)this._send(this._requestQueue.shift())},m._sendRequest=function(t,n){var r;r=new Image(1,1),e.isFunction(n)&&(r.onload=function(){r.onload=null,n()}),r.src=t},m._sendValidatingRequest=function(n){var r=this._get("validationCallback");t.get(n.url,function(t){e.isFunction(r)?r(t,n.data):t.error&&e.log("Invalid Magpie event:",t)})},m._loadBVID=function(){var e=this,n=e._trackerUrl("id.json",!0),r=e.getTrackerHostname();t.get(n,function(t){e._id=t,e._id.hostname=r,e._flushIdQueue()})},m._flushIdQueue=function(){var t=this._id,n=this._idQueue,r;while(n.length)r=n.shift(),e.isFunction(r)&&r(t)},m._unload=function(){if(this._unloaded)return;this.flushBatch(),this._unloaded=!0},m._setBrandCookies=function(t){if(t&&s.isSupported()){var n=new Date;s("BVBRANDID")||s("BVBRANDID",e.uuid(),{domain:t,path:"/",expires:new Date(n.getTime()+6310656e5)});var r=s("BVBRANDSID")||e.uuid();s("BVBRANDSID",r,{domain:t,path:"/",expires:new Date(n.getTime()+18e5)})}},m._getBrandCookies=function(){var e={BVBRANDID:null,BVBRANDSID:null};return this.getBrandDomain()!==null&&s.isSupported()&&(e.BVBRANDID=s("BVBRANDID")||null,e.BVBRANDSID=s("BVBRANDSID")||null),e},m._timing=function(){var e,t=window.performance||window.webkitPerformance||window.mozPerformance||window.oPerformance||window.msPerformance||!1;return t!==!1&&(e=t.timing)?{dns:e.domainLookupEnd-e.domainLookupStart,con:e.connectEnd-e.connectStart,req:e.responseStart-e.connectEnd,res:e.responseEnd-e.responseStart,load:e.loadEventStart-e.responseEnd,tot:e.loadEventEnd-e.navigationStart}:{}},m._isPII=function(e){return e&&e.substring(0,3).toLowerCase()==="pii"},m.setClient=function(e){this._shared.client=e},m.getClient=function(){return this._shared.client},m.setDisplay=function(e){this._shared.dc=e},m.getDisplay=function(){return this._shared.dc},m.setAnonymous=function(e){this._set("anonymous",e)},m.getAnonymous=function(){return this._get("anonymous")},m.setTrackerHostname=function(e){this._set("trackerHostname",e),this._id=null,this._bvCookiesRequest=h},m.getTrackerHostname=function(){return this._get("trackerHostname")},m.setAnonTrackerHostname=function(e){this._set("anonTrackerHostname",e)},m.getAnonTrackerHostname=function(){return this._get("anonTrackerHostname")},m.setBrandDomain=function(t){e.isString(t)&&t.length>0?this._setBrandCookies(t):t=null,this._set("brandDomain",t)},m.getBrandDomain=function(){return this._get("brandDomain")},m.enableTiming=function(){this._set("timing",!0)},m.disableTiming=function(){this._set("timing",!1)},m.setSource=function(e){this._shared.source=e},m.getSource=function(){return this._shared.source},m.setEnvironment=function(e){this._shared.environment=e},m.getEnvironment=function(){return this._shared.environment},m.setAudience=function(e){var t=this._shared;l[e]&&(e==="public"?delete t.audience:t.audience=e)},m.getAudience=function(){return this._shared.audience||"public"},m.enableValidation=function(t){this._set("validate",!0),e.isFunction(t)&&this._set("validationCallback",t),this._prevTracker=this.getTrackerHostname(),this._prevAnonTracker=this.getAnonTrackerHostname(),this.setTrackerHostname("schema.mag.bazaarvoice.com"),this.setAnonTrackerHostname("schema.mag.bazaarvoice.com")},m.disableValidation=function(){this._set("validate",!1),this._set("validationCallback",null),this._prevTracker&&(this.setTrackerHostname(this._prevTracker),this._prevTracker=null),this._prevAnonTracker&&(this.setAnonTrackerHostname(this._prevAnonTracker),this._prevAnonTracker=null)},m.isValidating=function(){return this._get("validate")},m.setStaging=function(e){this._set("staging",!!e),e&&(this.setTrackerHostname("network-stg.bazaarvoice.com"),this.setAnonTrackerHostname("network-stg-a.bazaarvoice.com"))},m.getStaging=function(){return this._get("staging")},m.setSecure=function(e){this._set("secure",!!e)},m.getSecure=function(){return this._get("secure")},m.getEventClassFilter=function(){return this._get("eventClassFilter")},m.setEventClassFilter=function(t){if(e.isString(t))try{t=new RegExp(t)}catch(n){}this._set("eventClassFilter",t)},m.getID=function(t){e.isFunction(t)&&(this._id?t(this._id):this._idQueue.push(t))},m.trackEvent=function(e,t){var n;if(this._filterClass(e))return;t=t||{},t.cl=e,f(t,"Brand","brand");if(this._isPII(e)){var r=this.getAnonymous(),i=this.getSecure();this.setSecure(!0),this.setAnonymous(!0),n=this._send(this._getPixel(t)),this.setAnonymous(r),this.setSecure(i)}else n=this._send(this._getPixel(t))},m.trackPageView=function(t){t=t||{},e.extend(t,i),this._get("timing")&&(t.t=this._timing());var n=this.trackEvent("PageView",t)},m.trackConversion=function(e){var t=u.create(e),n;t&&(t.containsPII()&&this.trackEvent(u.PII_EVENT_CLASS,t.getPIIData()),n=this.trackEvent(u.EVENT_CLASS,t.getAnonymizedData()))},m.addMeta=function(e,t){this._shared.meta||(this._shared.meta={}),this._shared.meta[e]=t},m.removeMeta=function(e){var t=this._shared.meta;e in t&&t.hasOwnProperty(e)&&delete t[e]},m.addBatch=function(e){this._batch&&this._batch.items.length>0&&this.flushBatch(),this._batch={data:e||{},items:[]}},m.addBatchItem=function(e,t){var n;if(this._filterClass(e))return;if(this._isPII(e))return this.trackEvent(e,t);t=t||{},t.cl=e,f(t,"Brand","brand"),this._batch||this.addBatch(),this._batch.items.push(t),n=this._getPixel(this.getBatch()),n.tooLong&&(this._batch.items.pop(),this._batch.items.length===0?this._send(n):(this.flushBatch(),this._batch.items.push(t)))},m.flushBatch=function(){if(!this._batch||!this._batch.items||this._batch.items.length===0)return;var e=this._send(this._getPixel(this.getBatch()));this._batch.items=[]},m.getBatch=function(){return this._batch?e.extend({batch:this._batch.items},this._batch.data):""},m.push=function(){try{var t;for(var n=0,r=arguments.length;n<r;n++){var i=arguments[n];if(e.isFunction(i))i.call(window);else if(e.isArray(i)){if(i.length===0)continue;var s=i[0];if(!e.isString(s)||s.charAt(0)==="_")continue;if(!e.isFunction(this[s]))continue;t=this[s].apply(this,i.slice(1))}}}catch(o){}return 1},m.resetLoadId=function(){this._shared.loadId=e.loadId()},m.setLoadId=function(e){this._shared.loadId=e},m.getLoadId=function(){return this._shared.loadId},m.configureSCIProvider=function(e,t){this._sciCallbacks.push(a.create(e,t))},v}),define("main",["lib/tracker"],function(e){window._bvaq=window._bvaq||[],window._bva=window._bva||new e,window._bvaq.length>0&&window._bva.push.apply(window._bva,window._bvaq),window._bvaq=window._bva;var t={};window._bva.createTracker=function(n,r){var i=(n||"")+"|"+(r||"");return t[i]=new e(n,r)},window._bva.getTracker=function(e,n){var r=(e||"")+"|"+(n||"");return t[r]||window._bva.createTracker(e,n)}});

})();

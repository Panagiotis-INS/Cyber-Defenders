var OHUB=OHUB||{},CMG=CMG||{};CMG.widget=CMG.widget||{};CMG.widget.standard=CMG.widget.standard||{};CMG.widget.standard.shell={common:CMG.widget.common,config:{lmt:"1411801398",base_url:null,widget_url:null,widget_id:null,parent_url:null,type:null,theme:null,width:null,layout:null,height:null,temp:null,is_theme_custom:false,is_overriden:false,old_widget_id:null,old_type:null,old_layout:null,old_width:null,old_height:null,old_theme_id:null,disqus_shortname:"outdoorhub",ref_domain:"",url_params:"",header_height:34,nav_height:23,footer_height:45,pane_type_height:null,pane_custom_height:null,pane_type_top:"57px",pane_custom_top:"35px",hide_header:false,hide_subnav:false,show_header:false,show_subnav:false,show_footer:false,is_mobile:false,widget_is_loaded:false,},id:{all:"hpw-widget-wrapper",container:"hpw-container",footer:"hpw-footer",main_content:"hpw-content-holder",header_container:"hpw-header-container",topic_header:"hpw-topic-header",topic_nav_container:"hpw-topic-nav-container",topic_nav:"hpw-topic-nav",topic_list_item:"hpw-topic-list",header_toggle:"hpw-header-toggle",type_header:"hpw-type-header",type_nav_container:"hpw-type-nav-container",type_nav:"hpw-type-nav",type_list_item:"hpw-type-list",loading:"hpw-loading"},options:{},data:{},templates:{},active_topic:null,active_index:null,active_type:null,active_type_index:null,type_height:null,flags:{first_init:true},pane_loaded:{},topic_index:{},standard_templates:{header_toggle:'<div id="hpw-header-toggle" class="hpw-border-color hpw-header-background hpw-topic-list hpw-toggle-icon">&mdash;<br>&mdash;<br>&mdash;</div>',topic_header:'<div id="hpw-topic-header" class="hpw-border-color hpw-header-background"></div>',topic_nav_container:'<div id="hpw-topic-nav-container"></div>',topic_nav:'<ul id="hpw-topic-nav"></ul>',type_header:'<div id="hpw-type-header" class="hpw-border-color hpw-type-header-background"></div>',type_nav_container:'<div id="hpw-type-nav-container"></div>',type_nav:'<ul id="hpw-type-nav"></ul>',featured_slider:'<div class="hpw-type-slider hpw-main-background"><div class="hpw-slider-images hpw-border-color">SLIDER_IMAGES</div><div class="hpw-slider-nav" style="width: SLIDER_WIDTH;">SLIDER_NAV</div></div>',left_arrow:'<div class="hpw-nav-scroll scroll-left-arrow" data-direction="left" style="left: 0">&#9664;</div>',right_arrow:'<div class="hpw-nav-scroll scroll-right-arrow" data-direction="right" style="right: 0">&#9654;</div>',share_button:'<div id="hpw-share"><span id="hpw-share-button" class="hpw-share-button">Get Widget <img src="/core/images/share-widget.png" border="0" align="absmiddle" /></span></div>',temp_full_message:'<div id="hpw-temp-message" class="hpw-content-message-container" style="display: none;"><p class="alert_message">Full article displays unavailable inside widget builder. You can view full displays in the widget preview once you have completed building and saved this widget.</p></div>',no_content:"Currently no items to list for this page. Please make a selection above.",load_more:'<article class="load-more-container"><h1 class="hpw-item-title hpw-load-more" data-offset="REPLACE_OFFSET">Load More Articles</h1></article>'},article_types:{news:"News",stories:"Stories",opinions:"Opinions","how-to":"How To",reviews:"Reviews",jobs:"Jobs"},article_type_num:6,init:function(b){OHUB.setup_cors();var a=this;if(this.common.mobile.is_mobile==true||this.common.mobile.is_tablet==true){this.config.is_mobile=true}this.config.type=b.type;this.config.widget_id=b.widget_id;this.config.dom_id=b.dom_id;this.config.ref_domain=b.ref;this.config.layout=b.layout;this.config.width=b.width;this.config.height=b.height;this.config.theme=b.theme;this.config.temp=b.temp;this.config.is_theme_custom=b.is_theme_custom;this.config.is_overriden=b.is_overriden;this.config.old_widget_id=b.old_widget_id;this.config.old_type=b.old_type;this.config.old_layout=b.old_layout;this.config.old_width=b.old_width;this.config.old_height=b.old_height;this.config.old_theme_id=b.old_theme_id;this.config.base_url=this.common.base_url();this.config.widget_url=this.common.widget_url(this.config.widget_id);this.config.parent_url=decodeURIComponent(document.location.hash.replace(/^#/,""));this.common.stats.ref=this.config.ref_domain;this.common.config.is_dev=(b.is_dev=="true")?true:false;this.debug("init(widget_id="+b.widget_id+", dom_id="+b.dom_id+", type="+b.type+", ref="+b.ref+")","info");this.message_handler();$hpw_.when(a.boot()).then(function(){var c=$hpw_.Deferred();$hpw_.when(a.topics.init(a),a.types.init(a),a.nav_structure(),a.content.init(a),a.index.init(a),a.change.init(a),a.featured_slider.init(a)).then(function(){c.resolve()});return c.promise()}).then(function(){return a.render()}).then(function(){return a.bindings.init(a)}).then(function(){a.show()})},boot:function(){var a=$hpw_.Deferred(),b=this;this.debug("boot()");$hpw_.when(b.common.fetch_config(b.config.temp,b.config.widget_id,b.config.type)).then(function(e){if(e===false){b.render_error()}else{b.options=e;var c=(b.config.layout!=="")?b.config.layout:b.options.layout;if(c!="custom"){b.options.layout={width:b.common.layouts[c].width,height:b.common.layouts[c].height}}else{b.options.layout={width:(b.config.width!=="")?b.config.width:b.options.width,height:(b.config.height!=="")?b.config.height:b.options.height}}b.options.height=b.options.layout.height;b.options.width=b.options.layout.width;b.options.layout.width-=2;b.options.layout.height-=2;if(b.config.theme!==""){var g=(b.options.theme.type!=="custom")?b.options.theme.url.lastIndexOf("/")+1:b.options.theme.url.lastIndexOf("/custom_css/")+1;b.options.theme.url="/core/css/themes/widget_"+b.config.theme+".css";$hpw_("#theme_style").attr("href",b.options.theme.url.replace("standard","core")+"?lmt="+b.config.lmt)}else{if(typeof(b.options.theme.base_theme_url)!="undefined"){$hpw_("#theme_base").attr("href",b.options.theme.base_theme_url.replace("standard","core")+"?lmt="+b.config.lmt)}var d=b.options.theme.url.replace("standard","core");d=d.replace("localhost","com");$hpw_("#theme_style").attr("href",d+"?lmt="+b.config.lmt)}b.config.show_header=b.options.has_header;b.config.show_subnav=b.options.has_nav;b.config.show_footer=b.options.has_footer;var f=b.common.templates.shell;f=f.replace("WW",b.options.layout.width+"px").replace("HH",b.options.layout.height+"px");$hpw_("body").append(f);$hpw_("#"+b.id.container).append(b.common.templates.header).append(b.common.templates.content).append(b.common.templates.footer).append(b.common.templates.loading).find("#"+b.id.loading).css("padding-top",Math.floor(b.options.layout.height/2)+"px");a.resolve()}});return a.promise()},nav_structure:function(){var e=this,b=$hpw_.Deferred();e.debug("nav_structure();");if(e.config.is_mobile){var d=e.config.header_height;if(e.config.show_footer){d+=e.config.footer_height}else{$hpw_("#hpw-footer").css("display","none")}var c=e.config.nav_height+d;e.config.show_header=true;e.config.show_subnav=true;e.config.pane_type_height=(e.options.height-c)+"px";e.config.pane_custom_height=(e.options.height-d)+"px";b.resolve()}else{var c=0,a=0;if(e.config.show_header){c+=e.config.header_height;a+=e.config.header_height;e.config.hide_header=false}else{e.config.hide_header=true}if(e.config.show_subnav){c+=e.config.nav_height;e.config.hide_subnav=false}else{e.config.hide_subnav=true}e.config.pane_type_top=c+"px";e.config.pane_custom_top=a+"px";if(e.config.show_footer){c+=e.config.footer_height;a+=e.config.footer_height;$hpw_("#hpw-footer").css("display","block")}else{$hpw_("#hpw-footer").css("display","none")}e.config.pane_type_height=(e.options.height-c)+"px";e.config.pane_custom_height=(e.options.height-a)+"px";if($hpw_("#"+e.id.header_toggle).length<=0){$hpw_("#"+e.id.header_container).prepend(e.standard_templates.header_toggle)}$hpw_(".hpw-article-container").css("height",e.config.pane_type_height).css("top",e.config.pane_type_top).find(".jspScrollable").css("height",e.config.pane_type_height);$hpw_(".hpw-custom-container").css("height",e.config.pane_custom_height).css("top",e.config.pane_custom_top).find(".jspScrollable").css("height",e.config.pane_custom_height);b.resolve()}e.nav_toggle.init(e);return b.promise()},render:function(){var f=$hpw_.Deferred(),d=this;d.active_topic=d.options.show_first_topic;d.active_type=d.options.show_first_topic_type;d.active_index=d.topic_index[d.active_topic].id;d.active_type_index=d.active_topic.indexOf("custom")===-1?d.topic_index[d.active_topic].types[d.active_type]:-1;if(d.options.is_co_branded){$hpw_("#"+d.id.footer).append($hpw_("<div />",{id:"hpw-co-brand-container"}));var c=$hpw_("<a />",{href:d.options.co_brand_url,target:"_blank"});var b=d.options.co_brand_image.name;var e=d.options.ad.server_urls.cobrand;var a=$hpw_("<img />",{src:e+"/"+b,border:0});if(d.options.co_brand_url!=null&&d.options.co_brand_url!=""){$hpw_("#hpw-co-brand-container").append(a);$hpw_("#hpw-co-brand-container img").wrap($hpw_(c));$hpw_("#hpw-co-brand-container a").bind("click",function(g){g.preventDefault();if($hpw_(this).attr("href")!==""){window.open($hpw_(this).attr("href"))}})}else{$hpw_("#hpw-co-brand-container").append(a)}}$hpw_.when(d.change.topic()).then(function(){f.resolve()});return f.promise()},bindings:{parent:null,init:function(a){var c=$hpw_.Deferred(),b=this;b.parent=a;b.parent.debug("bindings.init(parent="+typeof(a)+")");$hpw_.when(b.topics(),b.types(),b.load_more(),b.items(),b.sharing()).then(function(){c.resolve()});return c.promise()},topics:function(){var a=$hpw_.Deferred(),b=this;$hpw_(".hpw-topic").on("click",function(){var d=$hpw_(this).data("topic");if(d!=b.parent.active_topic){b.parent.active_topic=d;b.parent.active_index=b.parent.topic_index[d].id;$hpw_(".hpw-type-active").removeClass("hpw-type-active");if(b.parent.active_topic.indexOf("custom")===-1){for(var c in b.parent.topic_index[d].types){b.parent.active_type=c;b.parent.active_type_index=b.parent.topic_index[d].types[c];break}}else{b.parent.active_type="";b.parent.active_type_index=-1}b.parent.change.topic()}});a.resolve();return a.promise()},types:function(){var b=$hpw_.Deferred(),a=this;$hpw_(".hpw-type").on("click",function(){var c=$hpw_(this).data("type");if(c!=a.parent.active_type){$hpw_(".hpw-type-active").removeClass("hpw-type-active");$hpw_(this).addClass("hpw-type-active");a.parent.active_type=c;a.parent.active_type_index=a.parent.topic_index[a.parent.active_topic].types[c];a.parent.change.type(false)}});b.resolve();return b.promise()},load_more:function(){var b=this,a=$hpw_.Deferred();$hpw_("#"+b.parent.id.main_content).on("click",".hpw-load-more",function(){var c=$hpw_(this).data("offset");b.parent.debug("load_more.clicked(): offset="+c+",active_topic="+b.parent.active_topic+",active_type="+b.parent.active_type);$hpw_(this).parent().remove();b.parent.content.load_more(c)});a.resolve();return a.promise()},items:function(){var b=this,a=$hpw_.Deferred();$hpw_("#"+b.parent.id.main_content).on("click",".hpw-item",function(){var c,d;if(b.parent.active_topic.substring(0,6)=="custom"){c=$hpw_(this).data("type_id");d=null}else{c=b.parent.active_topic;d=$hpw_(this).data("type")}b.parent.load_type(c,d,$hpw_(this).data("id"))});a.resolve();return a.promise()},sharing:function(){var b=this,a=$hpw_.Deferred();if(b.parent.options.has_sharing){$hpw_("#hpw-share").bind("click",function(){var c={action:"share",widget_id:b.parent.config.widget_id,widget_type:b.parent.config.type,dom_id:b.parent.config.dom_id};b.parent.debug("clicked share");$hpw_.postMessage(c,b.parent.config.parent_url)})}a.resolve();return a.promise()}},show:function(){var d=this;d.nav_toggle.hide_all();var a=decodeURIComponent(document.location.hash.replace(/^#/,""));OHUB.debug("*** LOADED EVENT FIRED ***","info");$hpw_.postMessage({action:"widget_is_ready",widget_id:d.config.widget_id,widget_type:"standard",dom_id:d.config.dom_id},a);function c(){if($hpw_(".hpw-loaded").css("left")=="-50px"&&$hpw_("#hpw-last-check").css("text-indent")=="9999px"){if(d.options.is_theme_custom){if($hpw_("#hpw-last-check").css("top")=="-10px"){$hpw_("#"+d.id.all).css("visibility","visible");clearInterval(b)}}else{$hpw_("#"+d.id.all).css("visibility","visible");clearInterval(b)}}}var b=setInterval(c,50);d.common.comscore("general")},change:{parent:null,init:function(b){var a=$hpw_.Deferred();this.parent=b;this.parent.debug("change.init(parent="+typeof(b)+")");a.resolve();return a.promise()},topic:function(){var c=this,a=$hpw_.Deferred(),b=(c.parent.active_topic.indexOf("custom")===-1)?false:true;c.parent.debug("change.topic(topic="+c.parent.active_topic+";topic_index="+c.parent.active_index+")");$hpw_.when(c.parent.topics.change_topics()).then(function(){c.type(true)}).then(function(){a.resolve()});return a.promise()},type:function(b){var a=this,c=$hpw_.Deferred();a.parent.debug("change.type(type="+a.parent.active_type+";type_index="+a.parent.active_type_index+")");if(a.parent.active_type_index!=-1){$hpw_.when(a.parent.types.change_types(b)).then(function(){a.parent.content.load()}).then(function(){c.resolve()})}else{$hpw_(".hpw-type:visible").fadeOut("fast");$hpw_("#"+a.parent.id.type_header).find(".hpw-nav-scroll").remove();$hpw_.when(a.parent.content.load()).then(function(){c.resolve()})}return c.promise()}},content:{parent:null,init:function(a){var e=this;e.parent=a,init_def=$hpw_.Deferred(),topics=e.parent.options.topics;e.parent.debug("content.init(parent="+typeof(a)+")");for(var d=0;d<topics.length;d++){if(topics[d].is_custom=="1"){e.parent.pane_loaded[topics[d].name]={};e.parent.pane_loaded[topics[d].name]=false}else{for(var c=0;c<topics[d].types.length;c++){var b=topics[d].name+"-"+topics[d].types[c];e.parent.pane_loaded[b]={};e.parent.pane_loaded[b]=false}}if(d===topics.length-1){init_def.resolve()}}init_def.promise()},make_links:function(b){var a=/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig;return b.replace(a,"")},load:function(){var d=this,b=$hpw_.Deferred(),f="",e=0,c=false,a="";if(d.parent.active_topic.indexOf("custom")===-1){a=d.parent.active_topic+"-"+d.parent.active_type}else{a=d.parent.active_topic;c=true}d.parent.debug("content.load(parent="+a+")");if(d.parent.pane_loaded[a]){$hpw_(".hpw-content-container:visible").not("#"+a+"-container").hide();$hpw_("#"+a+"-container").show();if(d.parent.options.has_featured_content){d.parent.featured_slider.disable();if($hpw_(".hpw-type-slider:visible").length>0){d.parent.featured_slider.load_start()}}b.resolve()}else{$hpw_(".hpw-content-container:visible").hide();$hpw_("#"+d.parent.id.loading).show();$hpw_.when(d.fetch_data(e,c,a)).then(function(g){d.build_pane(g,a);d.parent.pane_loaded[a]=true}).then(function(){$hpw_("#"+d.parent.id.loading).hide();if(d.parent.options.has_featured_content){d.parent.featured_slider.disable();if($hpw_(".hpw-type-slider:visible").length>0){d.parent.featured_slider.load_start()}}b.resolve()})}return b.promise()},fetch_data:function(b,a,j){var e=$hpw_.Deferred(),g=this;if(a){var d="custom",c=null,h=j,i=g.parent.topic_index[g.parent.active_topic].id,f=0}else{var d=g.parent.active_type==="jobs"?"jobs":"news",c=g.parent.active_type,h=j,i=g.parent.active_topic,f=g.parent.topic_index[g.parent.active_topic]["vertical_id"]}load_url=g.parent.common.data_url({widget_id:g.parent.config.widget_id,topic:i,type:c,vertical_id:f,format:"list"});load_url+=(g.parent.config.temp!=null||g.parent.config.temp!="")?"?temp="+g.parent.config.temp:"?temp=";if(b!==0){load_url+="&offset="+b}load_url+="&lmt="+g.parent.config.lmt;load_url+="&vertical_id="+f;g.parent.debug("content.fetch_data(url="+load_url+")");$hpw_.jsonp({url:load_url,cache:true,callback:"cb",callbackParameter:"cb",success:function(k,l){e.resolve(k)},error:function(){g.parent.debug("fetch data error");e.resolve(null)}});return e.promise()},build_pane:function(c,i){var a=$hpw_.Deferred(),g=this;if(g.parent.active_topic.indexOf("custom")>=0){var f="hpw-custom-container",d=g.parent.config.pane_custom_height,e=g.parent.config.pane_custom_top,b=true}else{var f="hpw-article-container",d=g.parent.config.pane_type_height,e=g.parent.config.pane_type_top,b=false}var h=$hpw_("<div />",{id:i,"class":"hpw-content"}),j=$hpw_("<div />",{id:i+"-container","class":"hpw-content-container "+f,style:"height: "+d+"; top: "+e+";"});$hpw_("#"+g.parent.id.main_content).append(h).find("#"+i).wrap(j);g.parent.debug("content.build_pane(element="+i+")");if(c.list.items.length>0){$hpw_.when(g.load_data(c,i)).then(function(){g.parent.common.comscore(g.parent.active_topic);g.check_more(c,i,b)}).then(function(){a.resolve()})}else{g.load_empty(i);a.resolve()}return a.promise()},load_empty:function(a){var b=this;$hpw_("#"+a).height(b.parent.config.pane_type_height).addClass("content-error").html("<p>No content available for this subcategory.<br />Please make another selection from the navigation above.</p>")},load_data:function(e,i){var a=$hpw_.Deferred(),h=this,d="",f=h.parent.active_type,g=false,c=false,b=h.parent.active_topic.indexOf("custom")===-1?false:true;h.parent.debug("content.load_data(element="+i+";is_custom="+b+")");if(b){$hpw_.when(h.build_item_list(e,b,c,"custom")).then(function(j){$hpw_("#"+i).height(h.parent.config.pane_custom_height).append(j).jScrollPane({showArrows:true,horizontalGutter:0,autoReinitialise:true,contentWidth:h.parent.options.layout.width-15});a.resolve()})}else{if(h.parent.options.has_featured_content&&f!=="jobs"){if(e.list.featured_items_count>0){if(e.list.featured_items_count===3&&e.list.items_offset===0){g=true}else{(e.list.items_offset>0)?c=false:c=true}}}if(g){$hpw_.when(h.build_featured_list(e)).then(function(j){d+=j;return h.build_item_list(e,b,c,f)}).then(function(j){d+=j;$hpw_("#"+i).height(h.parent.config.pane_type_height).append(d).jScrollPane({showArrows:true,horizontalGutter:0,autoReinitialise:true,contentWidth:h.parent.options.layout.width-15});a.resolve()})}else{$hpw_.when(h.build_item_list(e,b,c,f)).then(function(j){d+=j;$hpw_("#"+i).height(h.parent.config.pane_type_height).append(d).jScrollPane({showArrows:true,horizontalGutter:0,autoReinitialise:true,contentWidth:h.parent.options.layout.width-15});a.resolve()})}}return a.promise()},check_more:function(e,b,d){var f=this,c=$hpw_.Deferred(),g=$hpw_("#"+b).find("article").length,a=d?e.items_total_count:e.list.items_total_count;f.parent.debug("check_more(data="+typeof(e)+",data_element="+b+",current_items="+g+",total_items="+a+")");if(g<a&&g<100){$hpw_("#"+b).find("article").filter(":first").parent().append(f.parent.standard_templates.load_more.replace("REPLACE_OFFSET",g));c.resolve()}else{c.resolve()}return c.promise()},load_more:function(g){var f=this,c=$hpw_.Deferred(),h="",d=false,b="",e="",a="";if(f.parent.active_topic.indexOf("custom")===-1){b=f.parent.active_topic+"-"+f.parent.active_type;e=f.parent.active_type}else{b=f.parent.active_topic;e="custom";d=true}f.parent.debug("content.load_more(parent="+b+",offset="+g+")");$hpw_("#"+f.parent.id.loading).show();$hpw_.when(f.fetch_data(g,d,b)).then(function(i){a=i;$hpw_.when(f.build_item_list(i,d,false,e)).then(function(j){$hpw_("#"+f.parent.id.loading).hide();$hpw_("#"+b).find("article").filter(":first").parent().append(j)}).then(function(){f.check_more(a,b,d)}).then(function(){c.resolve()})});return c.promise()},build_featured_list:function(c){var d=$hpw_.Deferred();my=this,items=c.list.featured_items,image_string="",list_string="",feat_string=my.parent.standard_templates.featured_slider,prune_title="",feat_width=my.parent.options.layout.width-166;my.parent.debug("content.build_featured_list()");for(var b=0;b<3;b++){items[b].title=items[b].title.replace("st.ohub.us?","st.ohub.us?ref="+my.parent.config.ref_domain+"&");if(items[b].title.indexOf("/>")!==-1){var a=items[b].title.indexOf("/>")+2;prune_title=items[b].title.substring(a)}else{prune_title=items[b].title}image_string+='<img src="'+items[b].images.thumbnail.url+'" class="hpw-featured-image hpw-item" data-id="'+items[b].id+'" data-type="'+items[b].type+'" data-num="'+b+'" />';list_string+='<span class="hpw-featured-title hpw-item hpw-border-color" title="'+prune_title+'" data-id="'+items[b].id+'" data-type="'+items[b].type+'" data-num="'+b+'">'+items[b].title+"</span>";if(b==2){feat_string=feat_string.replace("SLIDER_IMAGES",image_string);feat_string=feat_string.replace("SLIDER_NAV",list_string);feat_string=feat_string.replace("SLIDER_WIDTH",feat_width+"px");d.resolve(feat_string)}}return d.promise()},build_item_list:function(g,d,e,h){var a=$hpw_.Deferred(),k=this,c="",b=h!="custom"?g.list.items_count:g.items_count;var j=g.list.items;k.parent.debug("content.build_item_list(data="+typeof(g)+",is_custom="+d+",incl_featured="+e+",load_type="+h+",item_num="+b+")");for(var f=0;f<b;f++){j[f].title=j[f].title.replace("st.ohub.us?","st.ohub.us?ref="+k.parent.config.ref_domain+"&");switch(h){case"jobs":c+=k.load_job(j[f]);break;case"custom":c+=k.load_custom(j[f]);break;default:c+=k.load_article(j[f]);break}if(f===b-1){a.resolve(c)}}return a.promise()},load_job:function(c){var b='<article class="hpw-content-item clear"><h1 class="hpw-item-title hpw-item" data-type="'+c.type+'" data-id="'+c.id+'">'+c.title+"</h1><p><strong>Company/Organization:</strong> "+c.job_overview.brand+'<button class="hpw-right hpw-read-more-button hpw-item" data-type="'+c.type+'" data-id="'+c.id+'"><span class="hpw-read-more hpw-more-'+c.type+'">Read More</span></button>';if(c.job_overview.location!=""){b+="<br /><strong>Location:</strong> "+c.job_overview.location}var a=c.content!==null?c.content.replace("<p>",""):"";a=this.make_links(a);b+="</p><p>"+a;b+="</p></article>";return b},load_custom:function(d){var e=d.date.split(" "),b=moment(e[0],"YYYY-MM-DD").format("MMMM Do, YYYY"),c='<article class="hpw-content-item clear"><span class="hpw-item-date">'+b+'</span><h1 class="hpw-item-title hpw-item" data-type_id="'+d.feed_id+'" data-type="'+this.parent.topic_index[d.feed_id].name+'" data-id="'+d.id+'">'+d.title+"</h1><p>";if(d.image_url!==null&&d.image_url!==""){c+='<img src="'+d.image_url+'" data-type_id="'+d.feed_id+'" data-type="'+this.parent.topic_index[d.feed_id].name+'" data-id="'+d.id+'" class="hpw-list-image hpw-item hpw-image-border" align="left" />'}var a=d.content!==null?d.content.replace("<p>",""):"";a=this.make_links(a);c+=a;c+='</p><button class="hpw-right hpw-read-more-button hpw-item" data-type_id="'+d.feed_id+'" data-type="'+this.parent.topic_index[d.feed_id].name+'" data-id="'+d.id+'"><span class="hpw-read-more hpw-more-news">Read More</span></button>';c+="</article>";return c},load_article:function(d){var e=d.date.split(" "),b=moment(e[0],"YYYY-MM-DD").format("MMMM Do, YYYY"),c='<article class="hpw-content-item clear"><span class="hpw-item-date">'+b+" - by: "+d.author.name+'</span><h1 class="hpw-item-title hpw-item" data-type="'+d.type+'" data-id="'+d.id+'">'+d.title+"</h1><p>";if(d.images!==null&&d.images.thumbnail.url!==""){c+='<img src="'+d.images.thumbnail.url+'" data-type="'+d.type+'" data-id="'+d.id+'" class="hpw-list-image hpw-item hpw-image-border" align="left" />'}var a=d.content!==null?d.content.replace("<p>",""):"";a=this.make_links(a);c+=a;c+='</p><button class="hpw-right hpw-read-more-button hpw-item" data-type="'+d.type+'" data-id="'+d.id+'"><span class="hpw-read-more hpw-more-'+d.type+'">Read More</span></button>';c+="</article>";return c}},topics:{parent:null,init:function(a){var b=this;b.def=$hpw_.Deferred();b.parent=a;b.parent.debug("topics.init(parent="+typeof(a)+")");b.build_nav();return b.def.promise()},build_nav:function(){var a=this;a.parent.debug("topics.build_topics() started");$hpw_("#"+a.parent.id.header_container).prepend(a.parent.standard_templates.topic_header).find("#"+a.parent.id.topic_header).append(a.parent.standard_templates.topic_nav_container).find("#"+a.parent.id.topic_nav_container).append(a.parent.standard_templates.topic_nav);$hpw_.when(a.load_topics()).then(function(){a.size_topics()}).then(function(){a.def.resolve()})},load_topics:function(){var b=$hpw_.Deferred(),c=this;nav_num=c.parent.options.topics.length,nav_string="";for(var a=0;a<nav_num;a++){var d=c.parent.options.topics[a];nav_string+='<li id="hpw-topic-'+d.name+'" class="hpw-topic-list hpw-topic hpw-border-color" data-topic="'+d.name+'">';(d.alias!==""&&d.alias!==null)?nav_string+=d.alias:nav_string+=d.name;nav_string+="</li>";if(a===nav_num-1){$hpw_("#"+c.parent.id.topic_nav).append(nav_string);b.resolve()}}return b.promise()},size_topics:function(){var a=$hpw_.Deferred(),d=this,b=d.parent.options.topics.length,c=b;$hpw_("."+d.parent.id.topic_list_item).each(function(e){c+=$hpw_(this).outerWidth(true);if(e===b-1){$hpw_("#"+d.parent.id.topic_nav).css("width",c+"px");if(c>d.parent.options.layout.width){var f=d.parent.options.layout.width-50-c,g=Math.floor((d.parent.options.layout.width-50)/2);$hpw_("#"+d.parent.id.topic_header).append(d.parent.standard_templates.right_arrow).prepend(d.parent.standard_templates.left_arrow).find(".hpw-nav-scroll").addClass("hpw-topic-list");$hpw_("#"+d.parent.id.topic_header).find(".scroll-right-arrow").on("click",function(){d.parent.common.nav_scroll($hpw_("#"+d.parent.id.topic_nav),"right",f,g)});$hpw_("#"+d.parent.id.topic_header).find(".scroll-left-arrow").on("click",function(){d.parent.common.nav_scroll($hpw_("#"+d.parent.id.topic_nav),"left",0,g)});$hpw_("#"+d.parent.id.topic_nav_container).css("left","25px").css("width",d.parent.options.layout.width-50+"px");if(d.parent.config.is_mobile){$hpw_("#"+d.parent.id.topic_nav).bind("swiperight",function(){d.parent.common.nav_scroll($hpw_("#"+d.parent.id.topic_nav),"left",0,g)}).bind("swipeleft",function(){d.parent.common.nav_scroll($hpw_("#"+d.parent.id.topic_nav),"right",f,g)})}}a.resolve()}});a.promise()},change_topics:function(){var b=$hpw_.Deferred(),a=this;$hpw_(".hpw-topic-active").removeClass("hpw-topic-active");$hpw_("#hpw-topic-"+a.parent.active_topic).addClass("hpw-topic-active");if(a.parent.active_topic.indexOf("custom")===-1){a.parent.nav_toggle.is_custom_rss=false;a.parent.nav_toggle.can_move=true;a.parent.nav_toggle.show_subnav()}else{a.parent.nav_toggle.is_custom_rss=true;a.parent.nav_toggle.can_move=true;a.parent.nav_toggle.hide_subnav("")}b.resolve();return b.promise()}},types:{parent:null,type_width:0,has_sharing:false,init:function(a){var b=this;b.def=$hpw_.Deferred();b.parent=a;b.parent.debug("types.init(parent="+typeof(a)+")");if(b.parent.options.has_sharing){b.has_sharing=true;b.type_width=b.parent.options.layout.width-125}else{b.type_width=b.parent.options.layout.width}b.build_subnav();return b.def.promise()},build_subnav:function(){var d=this,a="",c=d.parent.article_type_num,b=1;$hpw_("#"+d.parent.id.header_container).append(d.parent.standard_templates.type_header).find("#"+d.parent.id.type_header).append(d.parent.standard_templates.type_nav_container).find("#"+d.parent.id.type_nav_container).css("width",d.type_width+"px").append(d.parent.standard_templates.type_nav);if(d.has_sharing){$hpw_("#"+d.parent.id.type_header).append(d.parent.standard_templates.share_button)}for(type in d.parent.article_types){a+='<li id="hpw-type-'+type+'" data-type="'+type+'" class="hpw-type-list hpw-type">'+d.parent.article_types[type]+"</li>";if(b===c){$hpw_("#"+d.parent.id.type_nav).append(a);d.def.resolve()}else{b++}}},change_types:function(g){var h=$hpw_.Deferred(),d=this,c=d.parent.options.topics[d.parent.active_index].types,f=$hpw_(".hpw-type:visible"),e=f.length,b=0;d.parent.debug("types.change(topic="+d.parent.active_index+")");function a(){$hpw_.when(d.size_types(c)).then(function(){for(var i=0;i<c.length;i++){if(i===d.parent.active_type_index){$hpw_("#hpw-type-"+c[i]).addClass("hpw-type-active").fadeIn("fast")}else{$hpw_("#hpw-type-"+c[i]).fadeIn("fast")}if(i===c.length-1){h.resolve()}}})}if(g){if(e>0){$hpw_(".hpw-type:visible").fadeOut("fast",function(){b++;if(b===e){a()}})}else{a()}}else{h.resolve()}return h.promise()},size_types:function(d){var a=$hpw_.Deferred(),h=this,e=d.length,f=d.length;h.parent.debug("types.size(topic="+h.parent.active_topic+";types="+d.join(",")+")");for(var c=0;c<d.length;c++){f+=$hpw_("#hpw-type-"+d[c]).outerWidth(true);if(c===d.length-1){h.parent.debug("nav_type_width="+f+";type_width="+h.type_width);$hpw_("#"+h.parent.id.type_nav).css("width",f+"px");if(f>h.type_width){var b=h.type_width-40-f,g=Math.floor((h.type_width-40)/2);$hpw_("#"+h.parent.id.type_nav_container).css("width",(h.type_width-40)+"px").css("left","20px").before(h.parent.standard_templates.left_arrow).after(h.parent.standard_templates.right_arrow.replace("right: 0","left: "+(h.type_width-20)+"px")).parent().find(".hpw-nav-scroll").addClass("hpw-type-list");$hpw_("#"+h.parent.id.type_header).find(".scroll-right-arrow").off("click").on("click",function(){h.parent.common.nav_scroll($hpw_("#"+h.parent.id.type_nav),"right",b,g)});$hpw_("#"+h.parent.id.type_header).find(".scroll-left-arrow").off("click").on("click",function(){h.parent.common.nav_scroll($hpw_("#"+h.parent.id.type_nav),"left",0,g)});if(h.parent.config.is_mobile){$hpw_("#"+h.parent.id.type_nav).unbind("swiperight swipeleft").bind("swiperight",function(){h.parent.common.nav_scroll($hpw_("#"+h.parent.id.type_nav),"right",b,g)}).bind("swipeleft",function(){h.parent.common.nav_scroll($hpw_("#"+h.parent.id.type_nav),"left",0,g)})}}else{$hpw_("#"+h.parent.id.type_nav_container).css("left","5px").css("width",h.type_width+"px").find("ul").css("left","0px").parent().parent().find(".hpw-nav-scroll").remove()}a.resolve()}}return a.promise()}},featured_slider:{parent:null,sliding:null,active_slide_num:0,total_slide_num:3,move_elem:null,init:function(a){this.parent=a;this.parent.debug("featured_slider.init(parent="+typeof(a)+")")},load_start:function(){var a=this;a.parent.debug("featured_slider.start()");a.active_slide_num=0;a.move_elem=$hpw_(".hpw-type-slider:visible");$hpw_(".hpw-featured-title-active").removeClass("hpw-featured-title-active");a.move_elem.find("span:first-child").addClass("hpw-featured-title-active");a.move_elem.find("img:first-child").show();this.start();$hpw_(".hpw-featured-title").off("mouseenter mouseleave").hover(function(){a.active_slide_num=$hpw_(this).data("num");a.move();a.pause()},function(){a.start()})},move:function(){var a=this;$hpw_(".hpw-featured-title-active").removeClass("hpw-featured-title-active");a.move_elem.find("img").hide();a.move_elem.find('span[data-num="'+a.active_slide_num+'"]').addClass("hpw-featured-title-active");a.move_elem.find('img[data-num="'+a.active_slide_num+'"]').show()},run:function(){var a=this;if(a.active_slide_num===a.total_slide_num-1){a.active_slide_num=0}else{a.active_slide_num++}a.move()},pause:function(){var a=this;window.clearInterval(a.sliding)},start:function(){var a=this;window.clearInterval(a.sliding);a.sliding=window.setInterval(function(){a.run()},5000)},disable:function(){this.pause();$hpw_(".ohw_slider_image").removeClass("ohw_slider_image_active");$hpw_(".ohw_slider_navigation_item").removeClass("ohw_slider_navigation_active")}},index:{parent:null,init:function(a){var b=this;b.parent=a;b.def=$hpw_.Deferred();b.parent.debug("index.init(parent="+typeof(a)+")");$hpw_.when(b.build_topic_index()).then(function(){b.def.resolve()});return b.def.promise()},build_topic_index:function(){var b=$hpw_.Deferred(),c=this.parent.options.topics;this.parent.debug("index.build_topic_index()");for(var a=0;a<c.length;a++){this.parent.topic_index[c[a].name]={id:(typeof(c[a].feed_id)!="undefined")?c[a].feed_id:a,vertical_id:typeof(c[a].vertical_id)!="undefined"?c[a].vertical_id:2};if(c[a].name.indexOf("custom")==-1){this.build_type_index(a,c[a].name)}else{this.parent.topic_index[c[a].feed_id]={name:c[a].name}}if(a===c.length-1){b.resolve()}}return b.promise()},build_type_index:function(b,a){var e=this.parent.topic_index[a],d=this.parent.options.topics[b].types;this.parent.debug("index.type_index(topic_id="+b+";topic_name="+a+")");e.types={};for(var c=0;c<d.length;c++){e.types[d[c]]=c}}},live_nav_toggle:function(b,a){var c=this;if(a=="true"){a=true}else{a=false}c.nav_toggle.can_move=true;if(b=="footer"){OHUB.debug("footer toggled shell builder "+a);c.config.show_footer=a}else{if(b=="header"){c.config.show_header=a;OHUB.debug("header toggled shell builder "+a);if(a){c.nav_toggle.show_header()}}else{if(b=="nav"){c.config.show_subnav=a;if(a){c.nav_toggle.show_subnav()}OHUB.debug("subnav toggled shell builder "+a)}}}OHUB.debug("firing nav structure update");c.nav_structure(function(){c.nav_toggle.hide_all()})},nav_toggle:{parent:null,header_visible:true,subnav_visible:true,can_move:false,visible_timeout:null,is_custom_rss:false,sub_height:0,head_height:0,init:function(a){this.parent=a;var b=this;b.can_move=true;this.parent.debug("nav_toggle.init");b.sub_height=b.parent.config.nav_height;b.head_height=b.parent.config.header_height;if(!b.parent.config.is_mobile){if(!b.parent.config.widget_is_loaded){$hpw_("#"+b.parent.id.header_container).hover(function(){b.parent.debug("header_container.hover(on)");b.parent.debug("can_move = "+b.can_move);clearTimeout(b.visible_timeout);b.show_all()},function(){b.parent.debug("header_container.hover(off)");clearTimeout(b.visible_timeout);b.visible_timeout=setTimeout(function(){b.can_move=true;b.hide_all()},1000)});b.visible_timeout=setTimeout(function(){b.hide_all()},1000)}}},hide_all:function(){var a=this;a.parent.debug("hide fired "+a.can_move);a.can_move=true;a.hide_subnav(function(){a.hide_header()});clearTimeout(a.visible_timeout)},hide_subnav:function(a){var b=this;if(b.parent.config.hide_subnav||b.is_custom_rss){$hpw_("#hpw-topic-nav li").css("height",(b.head_height-1)+"px");b.subnav_visible=false;$hpw_("#"+b.parent.id.type_header).stop().animate({top:String(0-b.sub_height)+"px"},400,"swing",function(){clearTimeout(b.visible_timeout);if(typeof(a)=="function"){a()}else{b.can_move=true}})}else{if(typeof(a)=="function"){a()}}},hide_header:function(){var a=this;if(a.parent.config.hide_header){$hpw_("#hpw-topic-nav li").css("height","33px");a.header_visible=false;if(!a.parent.config.hide_subnav&&a.subnav_visible){$hpw_("#"+a.parent.id.type_header).stop().animate({top:0},200,"swing")}$hpw_("#"+a.parent.id.topic_header).stop().animate({top:String(0-a.parent.config.header_height)+"px"},600,"swing");clearTimeout(a.visible_timeout);a.can_move=true}},show_all:function(){var a=this;a.parent.debug("show fired");if(a.can_move){a.can_move=false;a.show_header(function(){a.show_subnav()})}clearTimeout(a.visible_timeout)},show_header:function(a){var b=this;b.header_visible=true;if((!b.parent.config.hide_subnav||b.subnav_visible)&&!b.is_custom_rss){$hpw_("#hpw-topic-nav li").css("height","35px");$hpw_("#"+b.parent.id.type_header).stop().animate({top:b.parent.config.header_height+"px"},700,"swing")}$hpw_("#"+b.parent.id.topic_header).stop().animate({top:0},500,"swing",function(){clearTimeout(b.visible_timeout);if(typeof(a)=="function"){a()}else{b.can_move=true}})},show_subnav:function(){var b=this;b.parent.debug(this);if(b.is_custom_rss){b.hide_subnav("")}else{if(b.parent.active_topic.indexOf("custom")==-1){$hpw_("#hpw-topic-nav li").css("height","35px");b.subnav_visible=true;if(b.header_visible){var a=b.parent.config.header_height+"px"}else{var a=0}$hpw_("#"+b.parent.id.type_header).stop().animate({top:a},400,"swing")}else{b.hide_subnav("")}}clearTimeout(b.visible_timeout);b.can_move=true}},message_handler:function(){var a=CMG.widget.common.restricted_domain();$hpw_.receiveMessage(function(j){OHUB.debug("=== SHELL IFRAME LISTENER ===","info");OHUB.debug(j);var d=decodeURIComponent(j.data).split("&"),k={};for(var g=0;g<d.length;g++){var m=d[g].split("=");k[m[0]]=m[1]}if(k.action=="realtime"){for(var o in k){switch(o){case"theme":var h=decodeURI(k[o]);$hpw_("#custom_style").remove();var n='<style id="custom_style">'+h+"</style>";$hpw_("#theme_style").after(n);OHUB.debug("*** REALTIME: THEME *** : "+h,"info");break;case"loadtheme":var l={type:k.type,id:k.id,base:k.base};switch(l.type){case"standard":var f=l.base;f=f.replace("standard","core");break;case"custom":var f=a+"/widgets/themes/load/custom/"+l.id;break}$hpw_("#theme_base").attr("href",l.base);$hpw_("#theme_style").attr("href",f);OHUB.debug("*** REALTIME: LOADTHEME *** : "+$hpw_.param(l),"info");break;case"live-toggle":var b=k.status,c=k.elem;if(c=="footer"){OHUB.debug("footer toggled shell "+b)}else{if(c=="header"){OHUB.debug("header toggled shell "+b)}else{if(c=="nav"){OHUB.debug("subnav toggled shell "+b)}}}CMG.widget.standard.shell.live_nav_toggle(c,b);break}}}},a)},load_type:function(c,f,g){var e=this;if(e.config.temp==null||e.config.temp==""){var a=isNaN(c)?e.topic_index[c].vertical_id:0;var d={action:"load",widget_id:e.config.widget_id,topic:c,type:f,item_id:g,vertical_id:a,widget_type:e.config.type,dom_id:e.config.dom_id};$hpw_.postMessage(d,e.config.parent_url,parent)}else{$hpw_("#"+e.id.container).append(e.standard_templates.temp_full_message).find("#hpw-temp-message").show();var b=window.setTimeout(function(){$hpw_("#hpw-temp-message").remove()},3500)}return false},debug:function(a,b,d){var c="CMG.widget["+this.config.widget_id+"].standard.shell";this.common.debug(a,b,c,d)}};